tinymce.PluginManager.add('loadexcel', function(editor, url) {

  // Adds a menu item to the tools menu
  editor.addMenuItem('loadexcel', {
    text: 'Load from Excel',
    context: 'insert',
    onclick: function() {
      editor.windowManager.open({
        title: 'Load from Excel',
  			url: url + '/upload.html',
			  width: 700,
			  height: 500,
        buttons: [{
          text: 'Add',
          onclick: function(){
            param = tinymce.activeEditor.windowManager.getParams()
            editor.insertContent(param.table);
            tinymce.activeEditor.windowManager.close()
          }
        }, {
          text: 'Close',
          onclick: 'close'
        }]
      }, {
        table: ""
      });
    }
  });
});
